# ===============================================================
# Prepare tex table for parameters

# Define format of figures:
nb.dec <- 2 # number of decimal numbers
format.nb  <- paste("%.",nb.dec,"f",sep="")
format.nb0 <- paste("%.",0,"f",sep="")
format.nb1 <- paste("%.",1,"f",sep="")
format.nb5 <- paste("%.",5,"f",sep="")


latex.table <- rbind(
  paste("Time step &",
        "$\\Delta t $ &",
        "&",
        make.entry(model_sol$tstep,format.nb0),
        "&years &",
        "",
        "\\\\",sep=""),
  paste("Risk aversion&",
        "$\\gamma$&",
        "\\eqref{eq:logU}&",
        make.entry(model_sol$parameters$gamma,format.nb1),
        "& &",
        "",
        "\\\\",sep=""),
  paste("Discount factor (annual) &",
        "$1-\\delta^{\\frac{1}{\\Delta t}}$ &",
        "\\eqref{eq:logU}&",
        make.entry(100*(1-model_sol$parameters$delta^(1/model_sol$tstep)),format.nb),
        "&percent per year&",
        "",
        "\\\\",sep=""),
  paste("Capital depreciation rate &",
        "$dep$&",
        "\\eqref{eq:mucsigmac}&",
        make.entry(100-100*(1-model_sol$parameters$delta_K)^(1/model_sol$tstep),format.nb0),
        "&percent per year&",
        "",
        "\\\\",sep=""),
  paste("Avg ratio $M_{AT}\\big/M_{PI}$ over 2020-2100&",
        "$m_0$&",
        "\\eqref{eq:radforcAppendix}&",
        make.entry(model_sol$parameters$m0,format.nb),
        "&&",
        "CDICE+RCP",
        "\\\\",sep=""),
  paste("Decline rate of decarbonization &",
        "$\\delta_{\\sigma} $ &",
        "\\eqref{eq:carboIntensity}&",
        make.entry(100*model_sol$parameters$delsigma,format.nb),
        "&percent per period&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Industrial emissions in 2015 &",
        "$e_0$ &",
        "$(\\sigma_{0})$ &",
        make.entry(model_sol$parameters$e0,format.nb),
        "&GtCO$_2$ per year&",
        "CDICE",
        "\\\\",sep=""),
  paste("Initial world gross output in 2015 &",
        "$q_0 $ &",
        "\\eqref{eq:IndAppendix}&",
        make.entry(model_sol$parameters$q0,format.nb),
        "&trillions of 2010 USD&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Initial emission control rate in 2015 &",
        "$\\mu_0 $ &",
        "\\eqref{eq:IndAppendix}&",
        make.entry(100*model_sol$parameters$mu0,format.nb),
        "&percent&",
        "\\hl{DICE?}",
        "\\\\",sep=""),
  paste("Carbon intensity in 2015 &",
        "$\\sigma_{0} $ &",
        "\\eqref{eq:carboIntensity}&",
        "$\\frac{e_0}{q_0 (1-\\mu_0 )}=$",
        make.entry(model_sol$parameters$sigma0,format.nb),
        "&kgCO$_2$ per one thousand USD of 2015 production&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Initial growth of carbon intensity $\\sigma_1$ &",
        "$g_{\\sigma,1} $ &",
        "\\eqref{eq:carboIntensity}&",
        make.entry(100*model_sol$parameters$gsigma1,format.nb),
        "&percent per period &",
        "DICE2016",
        "\\\\",sep=""),
  paste("Backstop price  &",
        "$pback$ &",
        "\\eqref{eq:bckstopAppendix}&",
        make.entry(model_sol$parameters$pback,format.nb0),
        "&USD &",
        "\\hl{DICE2016}",
        "\\\\",sep=""),
  paste("Initial cost decline backstop cost &",
        "$gback $ &",
        "\\eqref{eq:bckstopAppendix}&",
        make.entry(100*model_sol$parameters$gback,format.nb),
        "&percent per period&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Exponent control cost function &",
        "$\\theta_2 $ &",
        "\\eqref{eq:adjLambdatAppendix}+\\eqref{eq:adjBackstopAppendix}&",
        make.entry(model_sol$parameters$theta2,format.nb),
        "&&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Carbon emissions from land in 2015 &",
        "$\\varepsilon_0 $ &",
        "\\eqref{eq:declineLand}&",
        make.entry(model_sol$parameters$eps_0,format.nb),
        "&GtCO$_2$ per year &",
        "DICE2016",
        "\\\\",sep=""),
  paste("Decline rate in land emissions &",
        "$\\rho $ &",
        "\\eqref{eq:declineLand}&",
        make.entry(100*model_sol$parameters$rho,format.nb),
        "&percent per period &",
        "DICE2016",
        "\\\\",sep=""),
  paste("2015 forcings of non-CO$_2$ GHG &",
        "$\\phi_0 $ &",
        "\\eqref{eq:exogradforcingAppendix}&",
        make.entry(model_sol$parameters$phi_0,format.nb),
        "&W/m$^2$&",
        "DICE2016",
        "\\\\",sep=""),
  paste("2100 forcings of non-CO$_2$ GHG &",
        "$\\phi_1 $ &",
        "\\eqref{eq:exogradforcingAppendix}&",
        make.entry(model_sol$parameters$phi_1,format.nb),
        "&W/m$^2$&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Equilibrium concentration in atmosphere &",
        "$mateq $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$mateq,format.nb0),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Equilibrium concentration in upper strata &",
        "$mueq $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$mueq,format.nb0),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Equilibrium concentration in lower strata &",
        "$mleq $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$mleq,format.nb0),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. from atm. to up. ocean &",
        "$\\varphi_{12} $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$varphi_12,format.nb5),
        "&&",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. from up. to lo. ocean &",
        "$\\varphi_{23} $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$varphi_23,format.nb5),
        "&&",
        "CDICE",
        "\\\\",sep=""),
  paste("Climate eq. coefficient for upper level &",
        "$\\xi_1 $ &",
        "\\eqref{eq:TatAppendix}&",
        make.entry(model_sol$parameters$xi_1,format.nb5),
        "&per period&",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. upper to lower stratum &",
        "$\\xi_2 $ &",
        "\\eqref{eq:TatAppendix}&",
        make.entry(model_sol$parameters$xi_2,format.nb5),
        "&per period &",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. for lower stratum &",
        "$\\xi_3 $ &",
        "\\eqref{eq:TloAppendix}&",
        make.entry(model_sol$parameters$xi_3,format.nb5),
        "&per period&",
        "CDICE",
        "\\\\",sep=""),
  paste("Forcings of equilibrium CO$_2$ doubling &",
        "$\\tau $ &",
        "\\eqref{eq:radforcAppendix}+\\eqref{eq:TatAppendix}&",
        make.entry(model_sol$parameters$tau,format.nb),
        "&W/m$^2$&",
        "CDICE",
        "\\\\",sep=""),
  paste("Equilibrium temperature impact &",
        "$\\nu $ &",
        "\\eqref{eq:TatAppendix}&",
        "3.25",
        "&\\degree C per doubling CO$_2$&",
        "CDICE",
        "\\\\",sep=""),
  # paste("Persistence RF shock &",
  #       "$\\Phi_{[2,2]} $ &",
  #       "\\eqref{eq:eta}&",
  #       make.entry(model_sol$parameters$Phi[2,2],format.nb),
  #       "&&",
  #       "",
  #       "\\\\",sep=""),
  paste("Coef. attached to $\\Delta T_{at,t}$ &",
        "$b_{SAT} $ &",
        "\\eqref{eq:SeaLAppendix}&",
        make.entry(model_sol$parameters$b_sat,format.nb5),
        "&m per \\degree C&",
        "\\citet{Vermeer_Rahmstorf_2009}",
        "\\\\",sep=""),
  paste("Base temperature for sea level equilibrium &",
        "$T_{0,S} $ &",
        "\\eqref{eq:SeaLAppendix}&",
        make.entry(model_sol$parameters$T_0s,format.nb5),
        "& per \\degree C&",
        "\\citet{Vermeer_Rahmstorf_2009}",
        "\\\\",sep=""),
  paste("Destruction of capital due to rising SL&",
        "$b_{SK} $ &",
        "\\eqref{eq:DeltaC}&",
        make.entry(model_sol$parameters$b_sk,format.nb5),
        "& &",
        "\\citet{Hinkel_etal_2014}",
        "\\\\",sep="")
  )
latex.file <- paste("outputs/Tables/table_param.txt",sep="")

write(latex.table, file = latex.file)

# paste(" &",
#       "$ $ &",
#       "\\eqref{eq:}&",
#       make.entry(model_sol$parameters$,format.nb),
#       "&",
#       "",
#       "\\\\",sep="")