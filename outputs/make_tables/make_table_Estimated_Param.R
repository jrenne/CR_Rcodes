# ==============================================================================
# Prepare tex table with estimated parameters
# ==============================================================================

# Define format of figures:
nb.dec <- 2 # number of decimal numbers
format.nb  <- paste("%.",nb.dec,"f",sep="")
format.nb0 <- paste("%.",0,"f",sep="")
format.nb1 <- paste("%.",1,"f",sep="")
format.nb2 <- paste("%.",2,"f",sep="")
format.nb3 <- paste("%.",3,"f",sep="")
format.nb4 <- paste("%.",4,"f",sep="")
format.nb5 <- paste("%.",5,"f",sep="")


latex.table <- rbind(
  "\\\\",
  "\\hline",
  "\\multicolumn{5}{l}{{\\bf Production function}}\\\\",
  paste("\\multicolumn{3}{l}{\\textit{Target: avg mean growth in the absence of climate risks}} &",
        make.entry(100*model_sol$target_vector["mu_c0"],format.nb1)," & \\%/period (5yrs)\\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Std dev. of growth in the absence of climate risks}} &",
        make.entry(100*model_sol$target_vector["sigma_c0"],format.nb1)," & \\%/period (5yrs)\\\\",sep=""),
  paste("Average TFP&",
        "$\\bar{A}$ &",
        "\\eqref{eq:AKmainText}&",
        make.entry(model_sol$parameters$A_bar,format.nb),
        "&",
        "\\\\",sep=""),
  paste("Standard deviation of TFP shock&",
        "$\\sigma_A$ &",
        "\\eqref{eq:AKmainText}&",
        make.entry(100*model_sol$parameters$sigma_a,format.nb),
        "& \\%",
        "\\\\",sep=""),
  "\\\\",
  "\\hline",
  "\\multicolumn{5}{l}{{\\bf Damage specification (excluding SLR-based damages)}}\\\\",
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected 2100 fractional damage conditional on $T_{AT}=2\\degree C$}} &",
        make.entry(100*(1-model_sol$target_vector[["ECumD2"]]),format.nb1)," & \\% \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected 2100 fractional damage conditional on $T_{AT}=4\\degree C$}} &",
        make.entry(100*(1-model_sol$target_vector[["ECumD4"]]),format.nb1)," & \\% \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Std dev. of 2100 fractional damage conditional on $T_{AT}=4\\degree C$}} &",
        make.entry(100*(model_sol$target_vector[["stdCumD4"]]),format.nb1)," & \\% \\\\",sep=""),
  paste("Uncertainty parameter&",
        "$\\mu_D$ &",
        "\\eqref{eq:damagemainText}&",
        make.entry(model_sol$parameters$mu_D,format.nb4),
        "&",
        "\\\\",sep=""),
  paste("Constant term in damage specification &",
        "$a^{(D)}$ &",
        "\\eqref{eq:damagemainText}&",
        make.entry(model_sol$parameters$a_D,format.nb4),
        "\\\\",sep=""),
  paste("Slope coefficient in damage specification &",
        "$b^{(D)}$ &",
        "\\eqref{eq:damagemainText}&",
        make.entry(model_sol$parameters$b_D,format.nb4),
        "\\\\",sep=""),
  "\\\\",
  "\\hline",
  "\\multicolumn{5}{l}{{\\bf Permafrost-related emissions}}\\\\",
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected 2100 release conditional on $T_{AT}=2\\degree C$}} &",
        make.entry(model_sol$target_vector[["ECumN2"]],format.nb1)," &GtCO$_2$ \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected 2100 release conditional on $T_{AT}=4\\degree C$}} &",
        make.entry(model_sol$target_vector[["ECumN4"]],format.nb1)," &GtCO$_2$ \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Std dev. of 2100 release conditional on $T_{AT}=4\\degree C$}} &",
        make.entry(model_sol$target_vector[["stdCumN4"]],format.nb1)," &GtCO$_2$ \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected release conditional on $T_{AT,\\infty}=4\\degree C$}} &",
        make.entry(model_sol$target_vector[["ECumNinf"]],format.nb1)," &GtCO$_2$ \\\\",sep=""),
  paste("Uncertainty parameter&",
        "$\\mu_N$ &",
        "\\eqref{eq:damage_NmainText}&",
        make.entry(model_sol$parameters$mu_N,format.nb1),
        "&",
        "\\\\",sep=""),
  paste("Constant term in carbon-release specification &",
        "$a^{(N)}$ &",
        "\\eqref{eq:damage_NmainText}&",
        make.entry(model_sol$parameters$a_N,format.nb1),
        "\\\\",sep=""),
  paste("Slope coefficient in carbon-release specification &",
        "$b^{(N)}$ &",
        "\\eqref{eq:damage_NmainText}&",
        make.entry(model_sol$parameters$b_N,format.nb1),
        "\\\\",sep=""),
  paste("Decay rate of releases &",
        "$\\kappa_N$ &",
        "\\eqref{eq:damage_NmainText}&",
        make.entry(model_sol$parameters$kappa_N,format.nb),
        "\\\\",sep=""),
  "\\\\",
  
  "\\hline",
  "\\multicolumn{5}{l}{{\\bf Sea-level rise (SLR)}}\\\\",
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected 2100 SLR conditional on $T_{AT}=2\\degree C$}} &",
        make.entry(model_sol$target_vector[["EH2"]],format.nb2)," & meter \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Expected 2100 SLR conditional on $T_{AT}=4\\degree C$}} &",
        make.entry(model_sol$target_vector[["EH4"]],format.nb2)," & meter \\\\",sep=""),
  paste("\\multicolumn{3}{l}{\\textit{Target: Std dev. of 2100 SLR conditional on $T_{AT}=4\\degree C$}} &",
        make.entry(model_sol$target_vector[["stdH4"]],format.nb2)," & meter \\\\",sep=""),
  paste("Uncertainty parameter in SLR specif.&",
        "$\\mu_{H}$ &",
        "\\eqref{eq:SeaL}&",
        make.entry(model_sol$parameters$mu_H,format.nb4),
        "&",
        "\\\\",sep=""),
  paste("Constant in SLR specif.&",
        "$a^{(\\Delta H)}$ &",
        "\\eqref{eq:SeaL}&",
        make.entry(model_sol$parameters$a_H,format.nb4),
        "&",
        "\\\\",sep=""),
  paste("Coefficient on $T_{AT}$ in SLR specif. &",
        "$b^{(\\Delta H)}$ &",
        "\\eqref{eq:SeaL}&",
        make.entry(model_sol$parameters$b_H,format.nb4),
        "&",
        "\\\\",sep=""),
  
  "\\\\",
  "\\hline",
  "\\multicolumn{5}{l}{{\\bf Uncertainty about temperature process}}\\\\",
  paste("\\multicolumn{3}{l}{\\textit{Target: Std dev. of 2100 atmospheric temperature}} &",
        model_sol$target_vector[["stdTat2100"]]," & \\degree C \\\\",sep=""),
  paste("Uncertainty parameter in $T_{AT}$ specification &",
        "$\\mu_T$ &",
        "\\eqref{eq:Tat}&",
        make.entry(model_sol$parameters$mu_T,format.nb4),
        "&",
        "",
        "\\\\",sep=""),
  
  "\\\\",
  "\\hline",
  "\\multicolumn{5}{l}{{\\bf Mitigation process}}\\\\",
  "\\multicolumn{3}{l}{\\textit{Based on agents' optimization on initial date}} \\\\",
  paste("Coef. on imposed function form of $\\mu_t$ &",
        "$\\theta_{a,opt} $ &",
        "\\eqref{eq:mu}&",
        make.entry(model_sol$theta.opt[1],format.nb3),
        "&",
        "",
        "\\\\",sep=""),
  paste("Coef. on imposed function form of $\\mu_t$ &",
        "$\\theta_{b,opt} $ &",
        "\\eqref{eq:mu}&",
        make.entry(abs(model_sol$theta.opt[2]),format.nb3),
        "&",
        "",
        "\\\\",sep="")
)

latex.file <- paste("outputs/Tables/table_param_est.txt",sep="")

write(latex.table, file = latex.file)

