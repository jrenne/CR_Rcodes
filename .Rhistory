plot(prices.ZCRF.bonds$P.t)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
plot(SCC$scc.decomp / 3.667)
H <- 200
# Compute prices of risk-free bonds:
omega.ZC <- matrix(0,model_sol_new$n.X,1)
prices.ZCRF.bonds <- varphi(model_sol_new,
omega.varphi = omega.ZC,
H = H)
plot(prices.ZCRF.bonds$P.t,type="l")
# Selection vector for Cum_dc:
omega_C <- matrix(0,model_sol_new$n.X,1)
omega_C[which(model_sol_new$names.var.X=="Cum_dc")] <- 1
#omega_C[which(model_sol_new$names.var.X=="T_at")] <- 1
epsilon <- .01
X.shock <- model_sol_new$X
X.shock[which(model$names.var.X=="M_at")] <- - epsilon +
X.shock[which(model$names.var.X=="M_at")]
prices.C   <- varphi(model_sol_new,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol_new,
omega.varphi = omega_C,
H = H,
X = X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
EC       <- NULL
EC.shock <- NULL
for(h in 1:H){
Uh <- matrix(model_sol_new$mu_c1,model_sol$n.X,h)
res.lt       <- multi.lt.fct.Uh(model_sol_new,Uh,X=model_sol_new$X,t=0)
res.lt.shock <- multi.lt.fct.Uh(model_sol_new,Uh,X=X.shock,t=0)
EC <- c(EC,res.lt$uX_t.h)
EC.shock <- c(EC.shock,res.lt.shock$uX_t.h)
}
#cbind(EC,EC.shock)
# Discounted expected benefits:
NPV <- sum(prices.ZCRF.bonds$P.t * (EC.shock - EC)/epsilon) *
10^3 * model$parameters$c0 / 3.667
SCC <- scc.fct.CRRA(model_sol_new,H=H)
cbind(SCC$SCC.CO2,NPV)
plot(SCC$scc.decomp / 3.667)
lines(prices.ZCRF.bonds$P.t * (EC.shock - EC)/epsilon *
10^3 * model$parameters$c0 / 3.667)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
plot(model_sol_new$mu)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
plot(prices.ZCRF.bonds$P.t,type="l")
prices.ZCRF.bonds$P.t
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
prices.ZCRF.bonds$P.t
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
prices.ZCRF.bonds$P.t
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
plot(EC - EC.shock)
plot(prices.ZCRF.bonds$P.t,type="l")
omega.ZC
varphi(model_sol_new,
omega.varphi = omega.ZC,
H = H)
plot(prices.ZCRF.bonds$r.t)
EV<-EV.fct(model_sol_new,H)
par(mfrow=c(2,3))
plot(model$vec_date[1:H],EV$EX$T_at,type="l")
lines(model$vec_date[1:H],EV$EX$T_atW,type="l",col="red")
lines(model$vec_date[1:H],EV$EX$T_at+2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$T_at-2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l")
model_sol_new$parameters$gamma <- gamma
model_sol_new$target_vector["mu_c0"] <- .06
model_sol_new$target_vector["sigma_c0"] <- .01
model_sol_new <- solveParam4c(model_sol_new,
indic_CRRA=TRUE)
model_sol_new$parameters$a_D  <- gamma * model_sol_new$parameters$a_D * 0
model_sol_new$parameters$b_D  <- gamma * .0018 * model$tstep * 0.01
model_sol_new$parameters$a_N  <- 0
model_sol_new$parameters$b_N  <- 0
#model_sol_new$parameters$mu_D <- gamma * model_sol_new$parameters$mu_D * 4
#model$parameters$mu_T <- model$parameters$mu_T * 3
model_sol_new$parameters$b_sk <- 0
model_sol_new <- model_solve(model_sol_new,
indic_mitig = F,
indic_CRRA = T)
#model_sol_new <- model_solve(model_sol_new)
H <- 100
EV<-EV.fct(model_sol_new,H)
par(mfrow=c(2,3))
plot(model$vec_date[1:H],EV$EX$T_at,type="l")
lines(model$vec_date[1:H],EV$EX$T_atW,type="l",col="red")
lines(model$vec_date[1:H],EV$EX$T_at+2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$T_at-2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l")
gamma <- 1.45
model_sol_new$parameters$gamma <- gamma
model_sol_new$target_vector["mu_c0"] <- .05
model_sol_new$target_vector["sigma_c0"] <- .01
model_sol_new <- solveParam4c(model_sol_new,
indic_CRRA=TRUE)
model_sol_new$parameters$a_D  <- gamma * model_sol_new$parameters$a_D * 0
model_sol_new$parameters$b_D  <- gamma * .0018 * model$tstep * 0.01
model_sol_new$parameters$a_N  <- 0
model_sol_new$parameters$b_N  <- 0
#model_sol_new$parameters$mu_D <- gamma * model_sol_new$parameters$mu_D * 4
#model$parameters$mu_T <- model$parameters$mu_T * 3
model_sol_new$parameters$b_sk <- 0
model_sol_new <- model_solve(model_sol_new,
indic_mitig = F,
indic_CRRA = T)
#model_sol_new <- model_solve(model_sol_new)
H <- 100
EV<-EV.fct(model_sol_new,H)
par(mfrow=c(2,3))
plot(model$vec_date[1:H],EV$EX$T_at,type="l")
lines(model$vec_date[1:H],EV$EX$T_atW,type="l",col="red")
lines(model$vec_date[1:H],EV$EX$T_at+2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$T_at-2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l")
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
lines(model$vec_date[1:H],EV$EX$delc,type="l",col="red")
plot(model$vec_date[1:H],EV$EX$delc,type="l")
lines(model$vec_date[1:H],EV$EX$delc+2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$delc-2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l",ylim=c(0,.05))
lines(model$vec_date[1:H],EV$EX$delc+2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$delc-2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l",ylim=c(-.02,.07))
lines(model$vec_date[1:H],EV$EX$delc+2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$delc-2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$Cum_D,type="l")
lines(model$vec_date[1:H],EV$EX$Cum_D+2*sqrt(EV$VX$Cum_D),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$Cum_D-2*sqrt(EV$VX$Cum_D),type="l",col="red",lty=2)
EV<-EV.fct(model_sol_new,H)
par(mfrow=c(2,3))
plot(model$vec_date[1:H],EV$EX$T_at,type="l")
lines(model$vec_date[1:H],EV$EX$T_atW,type="l",col="red")
lines(model$vec_date[1:H],EV$EX$T_at+2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$T_at-2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l",ylim=c(-.02,.07))
lines(model$vec_date[1:H],EV$EX$delc+2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$delc-2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$Cum_D,type="l")
lines(model$vec_date[1:H],EV$EX$Cum_D+2*sqrt(EV$VX$Cum_D),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$Cum_D-2*sqrt(EV$VX$Cum_D),type="l",col="red",lty=2)
H <- 20
EV<-EV.fct(model_sol_new,H)
par(mfrow=c(2,3))
plot(model$vec_date[1:H],EV$EX$T_at,type="l")
lines(model$vec_date[1:H],EV$EX$T_atW,type="l",col="red")
lines(model$vec_date[1:H],EV$EX$T_at+2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$T_at-2*sqrt(EV$VX$T_at),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$delc,type="l",ylim=c(-.02,.07))
lines(model$vec_date[1:H],EV$EX$delc+2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$delc-2*sqrt(EV$VX$delc),type="l",col="red",lty=2)
plot(model$vec_date[1:H],EV$EX$Cum_D,type="l")
lines(model$vec_date[1:H],EV$EX$Cum_D+2*sqrt(EV$VX$Cum_D),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$Cum_D-2*sqrt(EV$VX$Cum_D),type="l",col="red",lty=2)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
model_sol_new$parameters$mu_T
model_sol_new$parameters$mu_D
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
plot(model$vec_date[1:H],EV$EX$H,type="l")
lines(model$vec_date[1:H],EV$EX$H+2*sqrt(EV$VX$H),type="l",col="red",lty=2)
lines(model$vec_date[1:H],EV$EX$H-2*sqrt(EV$VX$H),type="l",col="red",lty=2)
model_sol_new$parameters$b_sk
EV$EX$H
.05*.1
model_sol_new$omega[1]
model_sol_new$A0.star.inf[1,]
model_sol_new$A1.inf[1,]
model_sol_new$A1[1]
model_sol_new$parameters$b_sk
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
model_sol_new$parameters$b_sk
model_sol_new$A1[1]
model_sol_new$omega[1]
model_sol_new$A1.inf[1,]
model_sol_new$omega.inf
model_sol_new$A1.inf
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
model_sol_new$A1.inf
model_sol$A1.inf
model_sol$ell1.H
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
model_sol_new$omega
model_sol_new$omega[1]
model_sol_new$A1[1]
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
model_sol_new$parameters$b_D
gamma * .0018 * model$tstep
model_sol_new$parameters$a_D
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai_SCC.R", echo=TRUE)
EV      <- EV.fct(model_sol,h=H)
ET.P    <- EV$EX$T_at[1:H]
ET.Q    <- varphi.tilde(model_sol,omega_T.at,H)[[1]]/
varphi(model_sol,omega_ZCB,H)[[3]]
model_sol_new$target_vector
?runif
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
runif(1,min=-1,max=1)
max.chge <- .5 # maximum absolute change in target
H <- model_sol$horiz.2100
model_sol_new$target_vector["ECumD2"] <- model_sol$target_vector["ECumD2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] +
(model_sol$target_vector["ECumD4"] - model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new <- solveParam4D(model_sol_new)
model_sol_new <- model_solve(model_sol_new,indic_CRRA = FALSE)
EV      <- EV.fct(model_sol_new,h=H)
ET.P    <- EV$EX$T_at[1:H]
ET.Q    <- varphi.tilde(model_sol_new,omega_T.at,H)[[1]]/
varphi(model_sol_new,omega_ZCB,H)[[3]]
# Prepare omega vectors (for pricing):
omega_ZCB  <- matrix(0,model_sol$n.X)
omega_T.at <- matrix(0,model_sol$n.X)
omega_T.at[which(model_sol$names.var.X=="T_at")] <- 1
TAT <- which(model_sol$names.var.X=="T_at")
EV      <- EV.fct(model_sol_new,h=H)
ET.P    <- EV$EX$T_at[1:H]
ET.Q    <- varphi.tilde(model_sol_new,omega_T.at,H)[[1]]/
varphi(model_sol_new,omega_ZCB,H)[[3]]
T.RP <- ET.Q - ET.P
T.RP
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
model_sol_new <- model_sol
model_sol_new$target_vector["ECumD2"] <- model_sol$target_vector["ECumD2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] +
(model_sol$target_vector["ECumD4"] - model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new <- solveParam4D(model_sol_new)
model_sol_new <- model_solve(model_sol_new,indic_CRRA = FALSE)
EV      <- EV.fct(model_sol_new,h=H)
ET.P    <- EV$EX$T_at[1:H]
ET.Q    <- varphi.tilde(model_sol_new,omega_T.at,H)[[1]]/
varphi(model_sol_new,omega_ZCB,H)[[3]]
T.RP <- ET.Q - ET.P
T.RP
max.chge
i <- 1
model_sol_new <- model_sol
model_sol_new$target_vector["ECumD2"] <- model_sol$target_vector["ECumD2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] +
(model_sol$target_vector["ECumD4"] - model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new <- solveParam4D(model_sol_new)
model_sol_new <- model_solve(model_sol_new,indic_CRRA = FALSE)
EV      <- EV.fct(model_sol_new,h=H)
ET.P    <- EV$EX$T_at[1:H]
ET.Q    <- varphi.tilde(model_sol_new,omega_T.at,H)[[1]]/
varphi(model_sol_new,omega_ZCB,H)[[3]]
T.RP <- ET.Q - ET.P
T.RP
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
stopCluster(cl)
stopCluster(cl)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
warnings()
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
load(file="essai.txt")
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
load(file="essai.Rdat")
model_sol_new$parameters$a_D
model_sol_new$parameters$b_D
model_sol_new$parameters$mu_D
model_sol$parameters$mu_D
model_sol_new
model_sol_new$target_vector
max.chge
(model_sol$target_vector["ECumD4"] - model_sol$target_vector["ECumD2"])
model_sol$target_vector
model_sol_new$target_vector
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD2"]
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD2"]
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD2"]
model_sol_new$target_vector["ECumD2"]
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] -
(model_sol$target_vector["ECumD2"] - model_sol$target_vector["ECumD4"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD2"]
model_sol_new$target_vector
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] -
(model_sol$target_vector["ECumD2"] - model_sol$target_vector["ECumD4"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] -
(model_sol$target_vector["ECumD2"] - model_sol$target_vector["ECumD4"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] -
(model_sol$target_vector["ECumD2"] - model_sol$target_vector["ECumD4"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
all.TempRP
??seed
set.seed(1)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
all.TempRP
model_sol_new$target_vector
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
all.TempRP
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
plot(density(all.TempRP[,16]))
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
model_sol_new$target_vector
model_sol_new$target_vector["ECumN2"] <- model_sol$target_vector["ECumN2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumN4"] <- model_sol_new$target_vector["ECumN2"] +
(model_sol$target_vector["ECumN4"] - model_sol$target_vector["ECumN2"]) *
model_sol_new$target_vector
model_sol_new$target_vector["ECumN4"] <- model_sol_new$target_vector["ECumN2"] +
(model_sol$target_vector["ECumN4"] - model_sol$target_vector["ECumN2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector
warnings()
model_sol_new$target_vector["ECumN2"] <- model_sol$target_vector["ECumN2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumN4"] <- model_sol_new$target_vector["ECumN2"] +
(model_sol$target_vector["ECumN4"] - model_sol$target_vector["ECumN2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
rug(all.TempRP[,16],col="red")
model_sol_new$target_vector
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
i <- 70
set.seed(i)
model_sol_new <- model_sol
# Damage targets:
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] -
(model_sol$target_vector["ECumD2"] - model_sol$target_vector["ECumD4"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["stdCumD4"] <- model_sol$target_vector["stdCumD4"] *
(1 + max.chge*runif(1,min=-1,max=1))
# Permafrost-related targets:
model_sol_new$target_vector["ECumN2"] <- model_sol$target_vector["ECumN2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumN4"] <- model_sol_new$target_vector["ECumN2"] +
(model_sol$target_vector["ECumN4"] - model_sol$target_vector["ECumN2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["stdCumN4"] <- model_sol$target_vector["stdCumN4"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumNinf"] <- model_sol$target_vector["ECumNinf"] *
(1 + max.chge*runif(1,min=-1,max=1))
# SLR targets:
model_sol_new$target_vector["EH2"] <- model_sol$target_vector["EH2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["EH4"] <- model_sol_new$target_vector["EH2"] +
(model_sol$target_vector["EH4"] - model_sol$target_vector["EH2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["stdH4"] <- model_sol$target_vector["stdH4"] *
(1 + max.chge*runif(1,min=-1,max=1))
# Consumption moment targets:
model_sol_new$target_vector["mu_c0"] <- model_sol$target_vector["mu_c0"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["sigma_c0"] <- model_sol$target_vector["sigma_c0"] *
(1 + max.chge*runif(1,min=-1,max=1))
# Temperature dynamics uncertainty:
model_sol_new$parameters$mu_T <- model_sol_new$parameters$mu_T *
(1 + max.chge*runif(1,min=-1,max=1))
i
model_sol_new$parameters
model_sol_new$parameters$mu_T
model_sol_new$target_vector
model_sol_new$parameters$mu_T <- model_sol_new$parameters$mu_T *
(1 + max.chge*runif(1,min=-1,max=1))
set.seed(i)
model_sol_new <- model_sol
# Damage targets:
model_sol_new$target_vector["ECumD2"] <- 1 - (1-model_sol$target_vector["ECumD2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumD4"] <- model_sol_new$target_vector["ECumD2"] -
(model_sol$target_vector["ECumD2"] - model_sol$target_vector["ECumD4"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["stdCumD4"] <- model_sol$target_vector["stdCumD4"] *
(1 + max.chge*runif(1,min=-1,max=1))
# Permafrost-related targets:
model_sol_new$target_vector["ECumN2"] <- model_sol$target_vector["ECumN2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumN4"] <- model_sol_new$target_vector["ECumN2"] +
(model_sol$target_vector["ECumN4"] - model_sol$target_vector["ECumN2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["stdCumN4"] <- model_sol$target_vector["stdCumN4"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["ECumNinf"] <- model_sol$target_vector["ECumNinf"] *
(1 + max.chge*runif(1,min=-1,max=1))
# SLR targets:
model_sol_new$target_vector["EH2"] <- model_sol$target_vector["EH2"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["EH4"] <- model_sol_new$target_vector["EH2"] +
(model_sol$target_vector["EH4"] - model_sol$target_vector["EH2"]) *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["stdH4"] <- model_sol$target_vector["stdH4"] *
(1 + max.chge*runif(1,min=-1,max=1))
# Consumption moment targets:
model_sol_new$target_vector["mu_c0"] <- model_sol$target_vector["mu_c0"] *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new$target_vector["sigma_c0"] <- model_sol$target_vector["sigma_c0"] *
(1 + max.chge*runif(1,min=-1,max=1))
# Temperature dynamics uncertainty:
model_sol_new$parameters$mu_T <- model_sol_new$parameters$mu_T *
(1 + max.chge*runif(1,min=-1,max=1))
model_sol_new <- solveParam4D(model_sol_new)
model_sol_new <- solveParam4H(model_sol_new)
model_sol_new <- solveParam4N(model_sol_new)
model_sol_new <- solveParam4c(model_sol_new)
model_sol_new <- model_solve(model_sol_new,indic_CRRA = FALSE)
model_sol_new$target_vector
model_sol$target_vector
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
model_sol_new$parameters
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_sol_new$parameters
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
model_solve(model_sol_new,indic_CRRA = FALSE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/outputs/make_figures/make_figure_ConfInt_RP.R", echo=TRUE)
