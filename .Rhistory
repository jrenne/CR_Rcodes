mu.function(model_sol,
theta = RES.2param$par,
t.ini = t)
plot(mu.function(model_sol,
theta = RES.2param$par,
t.ini = t))
lines(mu.function(model_sol,
theta = RES.Tmax.param$par,
t.ini = t))
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
pmax(pmin(theta,1),0)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
mu.function(model_sol,
theta = RES.Tmax.param$par,
t.ini = t)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
theta <- .5 + .99*(model_sol$mu[(t+1):model_sol$Tmax] - .5)
theta <- log(theta/(1-theta))
theta
RES.Tmax.param <- res.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X = Xt)
plot(mu.function(model_sol,
theta = RES.2param$par,
t.ini = t))
lines(mu.function(model_sol,
theta = RES.Tmax.param$par,
t.ini = t))
theta
RES.Tmax.param$par
theta <- RES.Tmax.param$par
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta
theta <- RES.Tmax.param$par
theta[2] <- 10
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta <- RES.Tmax.param$par
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 2
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 0
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta <- RES.Tmax.param$par
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 0
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta <- RES.Tmax.param$par
theta[1]
theta[1] <- 2
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 0
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 3
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 5
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta[1] <- 10
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
model_sol$omega0[[1]]
model_sol$omega0[[8]]
extract(model_sol$omega0,1)
plot(extract(model_sol$omega0,1))
length(extract(model_sol$omega0,1))
mu_aux <- mu.function(model_sol,
theta = theta,
t.ini = t)
essai <- mu_dep(model_sol,mu)
essai <- mu_dep(model_sol,mu_aux)
plot(extract(essai$omega0,1))
extract(essai$omega0,1)
model_sol$names.var.X
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
theta <- RES.Tmax.param$par
theta[1] <- 10
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
theta <- RES.Tmax.param$par
utility.optim(model_sol,
theta,
Tend = model_sol$Tmax - t,
X    = Xt)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/procedures/functions_general.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
model_sol$mu_c
model_sol$mu_c1
omega.ZC <- matrix(0,model_sol$n.X,1)
prices.ZCRF.bonds   <- varphi(model_sol,
omega.varphi = omega.ZC,
H = H)
H <- 200
# Returns of risk-free strategy:
omega.ZC <- matrix(0,model_sol$n.X,1)
prices.ZCRF.bonds   <- varphi(model_sol,
omega.varphi = omega.ZC,
H = H)
plot(prices.ZCRF.bonds$P.t)
H <- 100
# Returns of risk-free strategy:
omega.ZC <- matrix(0,model_sol$n.X,1)
prices.ZCRF.bonds   <- varphi(model_sol,
omega.varphi = omega.ZC,
H = H)
plot(prices.ZCRF.bonds$P.t)
plot(prices.ZCRF.bonds$P.t,type="l")
omega_A <- matrix(0,model_sol$n.X,1)
omega_A[which(model_sol$names.var.X=="Cum_dc")] <- 1
omega_A
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
omega_C <- matrix(0,model_sol$n.X,1)
omega_C[which(model_sol$names.var.X=="Cum_dc")] <- 1
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
plot(prices.C)
plot(prices.C$P.t)
nb.traj  <- 100
nb.simul <- H
test <- simul.function(model_sol,nb.simul,nb.traj)
dim(test$Cum_dc)
plot(test$Cum_dc[,1])
plot(test$Cum_dc[1,])
plot(test$Cum_dc[,1])
plot(test$Cum_dc[,2])
plot(test$Cum_dc[,4])
plot(test$Cum_dc[,5])
model$names.var.X
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="E")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
X=X.shock,
H = H)
D <- sum(prices.C) - sum(prices.C.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
X.shock
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="E")] <-
1 + X.shock[which(model$names.var.X=="E")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
X=X.shock,
H = H)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
X.shock
which(model$names.var.X=="E")
model_sol$X
model$names.var.X
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="M_at")] <-
1 + X.shock[which(model$names.var.X=="M_at")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
X=X.shock,
H = H)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
sum(prices.C$P.t)
sum(prices.C.shock$P.t)
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="M_at")] <-
100 + X.shock[which(model$names.var.X=="M_at")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
X=X.shock,
H = H)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
H = H,
X=X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
X.shock
model_sol$X
prices.C.shock
prices.C.shock$varphi1
omega_C
prices.C.shock$varphi0
H
prices.C.shock$P.t
plot(prices.C$P.t)
model_sol$A1[[1]]
model_sol$omega0[[1]]
model_sol$omega0[[2]]
model_sol$omega0[[20]]
model_sol$omega[[20]]
prices.C$varphi1[[1]]
prices.C$varphi1[[2]]
prices.C$varphi1[[0]]
prices.C$varphi0[[1]]
prices.C$varphi0
model_sol$names.var.X
omega_C <- matrix(0,model_sol$n.X,1)
#omega_C[which(model_sol$names.var.X=="Cum_dc")] <- 1
omega_C[which(model_sol$names.var.X=="T_at")] <- 1
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="M_at")] <-
100 + X.shock[which(model$names.var.X=="M_at")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
H = H,
X = X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="M_at")] <-
1 + X.shock[which(model$names.var.X=="M_at")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
H = H,
X = X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
D
sum(prices.C$P.t)
sum(prices.C.shock$P.t)
nb.traj  <- 1000
nb.simul <- H
test <- simul.function(model_sol,
nb.simul,
nb.traj)
model_sol_shock <- model_sol
model_sol_shock$X <- X.shock
test.shock <- simul.function(model_sol_shock,
nb.simul,
nb.traj)
plot(test$Cum_dc[H,])
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
mean8test$Cum_dc[H,]
mean(test$Cum_dc[H,])
mean(test.shock$Cum_dc[H,])
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol,
nb.simul,
nb.traj)
model_sol_shock <- model_sol
model_sol_shock$X <- X.shock
test.shock <- simul.function(model_sol_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="M_at")] <-
10 + X.shock[which(model$names.var.X=="M_at")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
H = H,
X = X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol,
nb.simul,
nb.traj)
model_sol_shock <- model_sol
model_sol_shock$X <- X.shock
test.shock <- simul.function(model_sol_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
print(apply(test$Cum_dc,1,mean),apply(test.shock$Cum_dc,1,mean))
apply(test$Cum_dc,1,mean)
print(cbind(apply(test$Cum_dc,1,mean),
apply(test.shock$Cum_dc,1,mean)))
plot(apply(test$Cum_dc,1,mean),type="")
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
plot(apply(test$Cum_dc,1,mean)-apply(test.shock$Cum_dc,1,mean),type="l")
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="E")] <-
1 + X.shock[which(model$names.var.X=="E")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
H = H,
X = X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol,
nb.simul,
nb.traj)
model_sol_shock <- model_sol
model_sol_shock$X <- X.shock
test.shock <- simul.function(model_sol_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
print(cbind(apply(test$Cum_dc,1,mean),
apply(test.shock$Cum_dc,1,mean)))
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
plot(apply(test$Cum_dc,1,mean)-apply(test.shock$Cum_dc,1,mean),type="l")
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol,
nb.simul,
nb.traj)
model_sol_shock <- model_sol
model_sol_shock$X <- X.shock
test.shock <- simul.function(model_sol_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
print(cbind(apply(test$Cum_dc,1,mean),
apply(test.shock$Cum_dc,1,mean)))
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
plot(apply(test$Cum_dc,1,mean)-apply(test.shock$Cum_dc,1,mean),type="l")
X.shock <- model_sol$X
X.shock[which(model$names.var.X=="E")] <-
10 + X.shock[which(model$names.var.X=="E")]
prices.C   <- varphi(model_sol,
omega.varphi = omega_C,
H = H)
prices.C.shock   <- varphi(model_sol,
omega.varphi = omega_C,
H = H,
X = X.shock)
D <- sum(prices.C$P.t) - sum(prices.C.shock$P.t)
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol,
nb.simul,
nb.traj)
model_sol_shock <- model_sol
model_sol_shock$X <- X.shock
test.shock <- simul.function(model_sol_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
print(cbind(apply(test$Cum_dc,1,mean),
apply(test.shock$Cum_dc,1,mean)))
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
plot(apply(test$Cum_dc,1,mean)-apply(test.shock$Cum_dc,1,mean),type="l")
ExpBenef <- apply(test.shock$Cum_dc,1,mean) - apply(test$Cum_dc,1,mean)
plot(ExpBenef,type="l")
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai2.R", echo=TRUE)
EC.shock <- apply(test.shock$Cum_dc,1,mean)
EC       <- apply(test$Cum_dc,1,mean)
ExpBenef <- EC.shock - EC
plot(ExpBenef,type="l")
DF <- varphi(model_sol,
omega.varphi = omega.ZC,
H = H)$P.t
DF.shock <- varphi(model_sol_shock,
omega.varphi = omega.ZC,
H = H)$P.t
sum(DF.shock*EC.shock - DF*EC)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai2.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai2.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai2.R", echo=TRUE)
model_sol_new <- model_sol
model_sol_new$target_vector
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai2.R", echo=TRUE)
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol_new,
nb.simul,
nb.traj)
model_sol_new_shock <- model_sol_new
model_sol_new_shock$X <- X.shock
test.shock <- simul.function(model_sol_new_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
print(cbind(apply(test$Cum_dc,1,mean),
apply(test.shock$Cum_dc,1,mean)))
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
EC.shock <- apply(test.shock$Cum_dc,1,mean)
EC       <- apply(test$Cum_dc,1,mean)
ExpBenef <- EC.shock - EC
plot(ExpBenef,type="l")
DF <- varphi(model_sol_new,
omega.varphi = omega.ZC,
H = H)$P.t
DF.shock <- varphi(model_sol_new_shock,
omega.varphi = omega.ZC,
H = H)$P.t
sum(DF.shock*EC.shock - DF*EC)
nb.traj  <- 10000
nb.simul <- H
test <- simul.function(model_sol_new,
nb.simul,
nb.traj)
model_sol_new_shock <- model_sol_new
model_sol_new_shock$X <- X.shock
test.shock <- simul.function(model_sol_new_shock,
nb.simul,
nb.traj)
plot(density(test$Cum_dc[H,]))
lines(density(test.shock$Cum_dc[H,]),col="red")
print(cbind(apply(test$Cum_dc,1,mean),
apply(test.shock$Cum_dc,1,mean)))
plot(apply(test$Cum_dc,1,mean),type="l")
lines(apply(test.shock$Cum_dc,1,mean),col="red")
EC.shock <- apply(test.shock$Cum_dc,1,mean)
EC       <- apply(test$Cum_dc,1,mean)
ExpBenef <- EC.shock - EC
plot(ExpBenef,type="l")
DF <- varphi(model_sol_new,
omega.varphi = omega.ZC,
H = H)$P.t
DF.shock <- varphi(model_sol_new_shock,
omega.varphi = omega.ZC,
H = H)$P.t
sum(DF.shock*EC.shock - DF*EC)
test$Cum_dc[H,]
test$Cum_dc[1,]
exp(8)
source("~/Dropbox/Research/TIBs/CR_Rcodes/main.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai2.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
source("~/Dropbox/Research/TIBs/CR_Rcodes/essai.R", echo=TRUE)
